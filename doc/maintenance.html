<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html">
<title>Build instructions, extensions and maintenance</title>
<link href="styles.css" rel="stylesheet" type="text/css">
</head>
<body>
<H1>Extensions and maintenance</H1>
<p>This page contains a number of loosely couple notes that are relevant for
people that are extending and/or maintaining the framework.</p>
<ul>
<li><a href="#build">Build instructions</a></li>
<li><a href="#standards">Coding standards</a></li>
<li><a href="#versioncontrol">Version control</a></li>
<li><a href="#extend">Creating extensions</a></li>
<li><a href="#portability">Portability</a></li>
</ul>

<H2><a name="build"/>Build instructions</H2>
<ul>
<li><a href="#linux">Build instructions on Linux and Unix platforms</a></li>
<li><a href="#cygwin">Build instructions on Windows using Cygwin compiler</a></li>
<li><a href="#bcc">Build instructions on Windows using Borland C++
compiler</a></li>
<li><a href="#vcc">Build instructions on Windows using Microsoft Visual C++
compiler</a></li>
<li><a href="#intel">Build instructions on Windows using Intel C++
compiler</a></li>
</ul>

<h3><a name="linux"/>Build instructions on Linux and Unix platforms</h3>
The following describes the steps you need to build Frepple.
<ol>
<li>Update your system with the development packages. The list below is what
you'ld need on top of a bare minimum Linux distribution.
 <ul>
  <li>Required for compiling the package:<ul>
   <li><b>gcc</b>, v3.2 or v4.0<br>
       Front end for the GNU compiler suite.</li>
   <li><b>gcc-c++</b>, compatible with gcc release<br>
       GNU C++ compiler.</li>
   <li><b>xerces-c</b>, v2.7 or later
       Xerces is a validating XML parser provided by the Apache Foundation.<br>
       Most distributions still come with an earlier release than required.</li>
  </ul></li>
  <li>Extras for development, testing, debugging, documentation, version
  control, etc:<ul>
   <li><b>autoconf</b>, v2.59 or later<br>
       Gnu Autoconf produces shell scripts to automatically configure software
       source code packages. This makes the source code easier to port across
       the different *nix flavors.</li>
   <li><b>automake</b>, v1.9.5 or later<br>
       Gnu Automake is a tool for automatically generating make-files.</li>
   <li><b>libtool</b>, v1.5 or later<br>
       Libtool hides the complexity of developing and using shared libraries
       for different platforms behind a consistent and portable interface.</li>
   <li><b>gdb</b>, compatible with gcc release<br>
       Debugger for the gcc environment.</li>
   <li><b>perl</b> and module <b>Time:HiRes</b>, v5.0.0.5 or higher<br>
       Perl is used as the scripting language for the test suite.</li>
   <li><b>doxygen</b>, any version should do<br>
       Extracts documentation from the C++ source code.</li>
   <li><b>subversion</b>, any version should do<br>
       Excellent version control tool.</li>
  </ul></li>
  <li>Used by some add-ons in the contrib subdirectory:<ul>
   <li><b>Apache httpd</b>, v2.x<br>
      The best web server around.<br>
      You'll need a version with a threaded MPM. I needed to compile my own
      version to achieve this.</li>
   <li><b>swig</b>, any version should do<br>
      SWIG is a software development tool that connects programs written in C
      and C++ with a variety of high-level programming languages. SWIG is used
      with different types of languages including common scripting languages
      such as Perl, PHP, Python, Tcl, Ruby and PHP.</li>
   <li><b>artistic style</b>, any version should do<br>
      A free, fast and small automatic formatter for C, C++, C# and java source
      code. Its home page is at <a href="http://astyle.sourceforge.net"
      target="_blank">http://astyle.sourceforge.net</a>.<br>
      Click <a target="main" href="maintenance.html#standards">here</a> to see
      the configuration parameters we use for Artistic Style.</li>
   <li><b>GLPK</b>, any version should do<br>
      The GLPK (GNU Linear Programming Kit) package is intended for solving
      large-scale linear programming (LP), mixed integer programming (MIP) and
      other related problems. It can be downloaded from
      <a href="http://www.gnu.org/software/glpk/glpk.html" target="_blank">
      http://www.gnu.org/software/glpk/glpk.html</a></li>
   <li><b>Python</b>, version greater or equal to 2.4<br>
      Python is a modern, easy to learn interpreted programming language. See
      <a href="http://www.python.org" target="_blank">http://www.python.org</a>
      for more information. A module is available that embeds a python
      interpreter in frepple, allowing complex actions and operations to be
      coded easy and flexibly.</li>
   <li><b>NSIS</b>, version greater or equal to 2.07<br>
      NSIS, which stands for "Nullsoft Scriptable Installation System", is a
      free scriptable win32 installer/uninstaller system that doesn't suck
      and isn't huge. This program can be downloaded from <a
       href="http://nsis.sf.net" target="_blank">http://nsis.sf.net</a> and
      you'll only need it if you are planning to create a windows installation
      package.</li>
   <li><b>Java</b><br>
      Java is used to demonstrate Frepple in a J2EE environment.</li>
  </ul></li>
  </ul>
</li>
<li>Change to the frepple installation directory.</li>
<li>This step applies <b>only</b> when you build the project from the SVN repository
(rather than a source tar file).<br>
Issue the command '<i>make -f Makefile.dist prep</i>' to run the gnu autoconf
suite.</li>
<li>Issue the command '<i>./configure</i>' to specify the build options and detect
the specifics of your platform.</br> Use the command './configure --help' to see
the list of available options.</li>
<li>Issue the command '<i>make all</i>' to compile the code.</li>
<li>Issue the command '<i>make check</i>' to run the test suite.</li>
<li>Issue the command '<i>make install</i>' to install the files.</li>
<li>You can issue the command '<i>make clean</i>' to free the disk space used during
the build and test phases.</li>
</ol>

<h3><a name="cygwin"/>Build instructions on Windows using Cygwin compiler</h3>
The build instructions on Cygwin are similar with the Linux and Unix platforms.
Cygwin does provide all the packages listed above (except the xerces-c version,
which is older).<br>
The Cygwin environment can be downloaded free of charge from the
<a href="http://www.cygwin.com" target="_blank">Cygwin website</a>.
<br>
To build the latest xerces library for cygwin, remove the eventual
previous xerces release in your cygwin director, download the source from the
xerces web page and then follow the build instructions. (Hint: Use the
following to configure the build:
  "./runConfigure -p cygwin -c gcc -x g++ -P /usr"<br>
Compared to the other compilers for Windows the executables generated from the
cygwin compiler are considerably slower. That's the price for an emulation
layer...

<h3><a name="bcc"/>Build instructions on Windows using Borland C++ compiler</h3>
The Frepple source distribution comes with a Borland C++ compiler make file
and detailed compilation instructions in a README.txt file. Both are located
in the subdirectory contrib/borland.<br>
The Borland compiler can be downloaded free of charge from the
<a href="http://www.borland.com" target="_blank">Borland website</a>.<br>
Disclaimer: The borland build hasn't been kept up to date for a while now.
Compiling the main executables should be fine, but compiling the modules will fail.

<h3><a name="vcc"/>Build instructions on Windows using Microsoft Visual C++
compiler</h3>
The Frepple source distribution comes with Microsoft Visual C++ projects and
workspaces to build Frepple. The solution file is contrib/vc/frepple.sln.
Detailed build instructions are provided in the file contrib/vc/README.txt.<br>
The project configuration files are generated with version 8 of Visual C++ and
unfortunately are not compatible with earlier releases :-(  :-( :-(<br>
A free version, called "Visual C++ 2005 Express Edition", can be downloaded from
the Microsoft website.

<h3><a name="intel"/>Build instructions on Windows using Intel C++ compiler</h3>
The intel compiler integrates in the Microsoft Studio development environment.
The project files provided for the Microsoft compiler can be automatically
migrated to use the Intel compiler in the Microsoft IDE.<br>
I haven't tried out compilation from the command line yet, or using the
specific optimization methods provided by the Intel compiler<br>
An evaluation copy of Intel compiler can be downloaded free of charge from the
<a href="http://www.intel.com" target="_blank">Intel website</a>.

<H2><a name="standards"/>Coding standards</H2>
<p>The project tries to follow the coding standards outlined in the corelinux
project. The corelinux project is an open source project hosted on
SourceForge.com
See the documentation on <a href="http://corelinux.sourceforge.com"
target="_blank">http://corelinux.sourceforge.com</a>
<p>To format the source we will use the 'artistic style' tool. The following
options are used:<br>
	--style==ansi<br>
	--indent=spaces=2<br>
	--indent-classes<br>
	--indent-switches<br>
	--break-blocks<br>
	--min-conditional-indent=2
</p>

<H2><a name="versioncontrol"/>Version control</H2>
<p>The software changes are tracked with subversion on the Sourceforge site.
The repository is accessible to everybody. Complete instructions are available
on <a target="_blank" href="http://sourceforge.net/svn/?group_id=166214">
this page</a>.</p>
<p>A example subversion configuration is available in the file
subversion.config for convenience. In particular the section on the automatic
properties is of interest when you start adding files to the project.</p>

<H2><a name="extend"/>Creating extensions to the standard framework</H2>
<p>Frepple is designed to be extendable. Additional modeling and solver modules
can be included at runtime without recompiling the library. The extension
modules can be shipped with Frepple, or can be developed by third parties (even
commercial).</p>
<p>The steps below define how a custom extension can be build on the framework.
A basic assumption for this process is that we want to clearly seperate the
custom extension from the standardized framework, in order to facilitate
maintaining and upgrading your solution.</p>
<ul>
<li>Create your own header files, which will need to include the file planner.h
</li>
<li>Create your own c++ source files implementing the defined functions. Include
you customized header file.</li>
<li>Create you own client. The standard client uses the standard header files,
and at least you copy the standard client code and include your own header
file.</li>
<li>In your favorite development environment, set up your own processes to
build, document, configure, version, ... your solution.</li>
<li>All of the steps described below for the standard framework will also apply
for your customized solution.</li>
</ul>

<H2>Updating the standard framework</H2>
<p>Such updates will need the following updates to keep everything up to
date:<ul>
<li>Update the header files and write the code implementing the methods. Don't
forget the inline documentation in the code!</li>
<li>Run the test suite. Update and add if appropriate. The command is 'make
check' in the root directory of the project.</li>
<li>Regenerate the documentation extracted by DOxygen from the source code. This
is done by running make in the doc subdirectory.</li>
<li>Update the class diagram (in Microsoft Visio)</li>
<li>Update the modeling documents which act as the end user
reference for the API.</li>
<li>Update the XML Schema definition files plan.xsd and planner.xsd.</li>
<li>Rebuild and test the distribution. The command is 'make dist; tar xzf
planner-&lt;rel&gt;.tar.gz;cd planner-&lt;rel&gt;;./configure;make;make check'.
</li>
<li>Rebuild the windows installer. Since the windows installer is based on the
distribution, the previous step needs to finish without problems before you try
this step.</li>
</ul><p/>

<H2><a name="portability"/>Portability</H2>
<p>The project is currently compiled and tested only for 32-bit linux and
Windows environments, with Linux being the primary development platform. Porting
to other platforms is encouraged - you'll have all my support in helping with
this.</p>
<p>Here are some areas where porting may be a bit challenging:<ul>
<li>Availability of a modern C++ compiler and STL.</li>
<li>File system functions such as fstat, paths, directory listings</li>
<li>Availability of the Pthreads library for threading.</li>
<li>Availability of the Xerces-C XML parser.</li>
<li>Shared libraries<br>
Currently the code only supports the dlopen (Solaris, Linux and various BSD
flavors) and LoadLibrary (Windows) functions. HPUX uses different function name
shl_load, and AIX doesn’t allow shared libs depending on other shared libs.</li>
</ul><p/>

<H2>Miscelaneous notes</H2>
<ul>
<li>The proper distribution is the source tar-ball. The windows installer is
provided for convenience only.</li>
<li>Avoid building distributions using cygwin. Distributions made on this
platform are not easily usable on UNIX or Linux platforms (because some script
files get dos end-of-line characters and can't be run). Distributions made on
UNIX and Linux are usable without any problem on the cygwin platform.</li>
</ul>

</body>
</html>